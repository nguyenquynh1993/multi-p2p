#summary One-sentence summary of this page.

= Introduction =

Install IMS Core 


= Details =
I) Install OpenIMSCore with IP localhost : 127.0.0.1 
1) Prerequisites: 
a. libxml2 
b. libmysql 
c. bind9
d. bison
e. flex
f. mysql-server
g. ant
h. make
i. jdk1.5
j. gcc3/4  

2. Go to / directory through command prompt and

#mkdir opt
#cd opt
#mkdir OpenIMSCore
#cd OpenIMSCore
#mkdir ser_ims
#mkdir FHoSS

3. Change the permissions for opt folder created:
#chmod 777 -R /opt

4. Check out the code for OpenIMSCore
#cd /opt/OpenIMSCore/ 

5.Create a new directory ser_ims and checkout the CSCFs there:
#mkdir ser_ims
#svn checkout http://svn.berlios.de/svnroot/repos/openimscore/ser_ims/trunk ser_ims

6.Create a new directory FHoSS and checkout the HSS there:
#mkdir FHoSS
#svn checkout http://svn.berlios.de/svnroot/repos/openimscore/FHoSS/trunk FHoSS

7.Compile ser_ims
#cd ser_ims
#sudo make install-libs all

8.Configure FHoSS
*If you don't have a JDK >=1.5, get one before proceeding
*Make sure, that the JDK version that you are using is >= 1.5!!!
# java -version

Do "ant compile deploy" in FHoSS
New!!! "ant gen" is not needed any more!!!

#cd FHoSS
#ant compile
#ant deploy
#cd .. 

9.Configure the Environment
* All the installation examples configured to work only on the local loopback and the default domain configured as "open-ims.test".
* The MySQL access rights are set only for local access
* We recommend that you try it first like this and then do your changes:
  o Replace 127.0.0.1 where required with your IP address
  o Replace the home domain (open-ims.test) with your own one
  o Change the database passwords
For this operation the ser_ims/cfg/configurator.sh might help you. 

11.Configure DNS
    * A sample DNS zone file can be found in ser_ims/cfg/open-ims.dnszone
     * Edit /etc/bind/named.conf by adding following zone in it:
          zone "open-ims.test" {
              type master;
              file "/etc/bind/open-ims.dnszone";
          };

     * Copy open-ims.dnszone file to /etc/bind/
          #sudo cp ser_ims/cfg/open-ims.dnszone etc/bind/

     *Edit /etc/resolv.conf
          # Generated by NetworkManager
            search open-ims.test
            domain open-ims.test
            nameserver 127.0.0.1

      * Edit etc/hosts
           127.0.0.1 localhost
           127.0.1.1 raziya-laptop
           127.0.0.1 open-ims.test mobicents.open-ims.test ue.open-ims.test presence.open-ims.test icscf.open-ims.test scscf.open-ims.test pcscf.open- ims.test hss.open-ims.test

# The following lines are desirable for IPv6 capable hosts
::1 localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

      * Restart bind server:
         #sudo /etc/init.d/bind9 restart


12. Configure MySQL
    * Run the SQL dumps (mysql -u root -p -h localhost < dump.sql):
      mysql -u root -p -h localhost < ser_ims/cfg/icscf.sql
      mysql -u root -p -h localhost < FHoSS/scripts/hss_db.sql  
      mysql -u root -p -h localhost < FHoSS/scripts/userdata.sql

13. Start all nodes and hss:
     #cd opt/OpenIMSCore
     #./pcscf.sh
     #./scscf.sh
     #./icsscf.sh
     #cd FHoSS/deploy
     #sh startup.sh

II) Configure OpenIMSCore with real IP : 
1. edit /etc/resolv.conf
2. edit /etc/hosts
3. edit /etc/bind/open-ims.test
4. restart bind: sudo /edit/init.d/bind9 restart
5. check: dig open-ims.test
6. Change Nodes setting:
   6.1 icscf.cfg & icscf.xml (opt/OpenIMSCore/)
   6.2 pcscf.cfg & pcscf.xml
   6.3 scscf.cfg & scscf.xml
7. Change FHoSS setting
   7.1 DiameterPeerHSS.xml (FHoSS/deploy)
   7.2 hss.properties (FHoSS/deploy)
=> Check the web interface on : http://127.0.0.1:8080/

III) Add new user in OpenIMSCore 
* Change scrip add-imscore-user_newdb.sh to remove comments in created script sql  
* Use scrip add-imscore-user_newdb.sh  

